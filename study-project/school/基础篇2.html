<!DOCTYPE html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.60" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://vuepress-theme-hope-docs-demo.netlify.app/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html"><meta property="og:site_name" content="小蔡coding"><meta property="og:title" content="技术整合"><meta property="og:description" content="整合NUXT 什么是NUXT？ 一种服务端渲染技术 1、什么是服务端渲染 服务端渲染又称SSR (Server Side Render)是在服务端完成页面的内容，而不是在客户端通过AJAX获取数据。 服务器端渲染(SSR)的优势主要在于：更好的 SEO，由于搜索引擎爬虫抓取工具可以直接查看完全渲染的页面。 如果你的应用程序初始展示 loading 菊花..."><meta property="og:type" content="article"><meta property="og:locale" content="en-US"><title>技术整合 | 小蔡coding</title><meta name="description" content="整合NUXT 什么是NUXT？ 一种服务端渲染技术 1、什么是服务端渲染 服务端渲染又称SSR (Server Side Render)是在服务端完成页面的内容，而不是在客户端通过AJAX获取数据。 服务器端渲染(SSR)的优势主要在于：更好的 SEO，由于搜索引擎爬虫抓取工具可以直接查看完全渲染的页面。 如果你的应用程序初始展示 loading 菊花...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-b0136e4c.css" as="style"><link rel="stylesheet" href="/assets/style-b0136e4c.css">
    <link rel="modulepreload" href="/assets/app-18c23253.js"><link rel="modulepreload" href="/assets/framework-f12b30cc.js"><link rel="modulepreload" href="/assets/基础篇2.html-e2a0e9ec.js"><link rel="modulepreload" href="/assets/基础篇2.html-00d410f9.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/logo.png" alt="小蔡coding"><!----><span class="site-name hide-in-pad">小蔡coding</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><form class="search-box" role="search"><input type="search" placeholder="搜索" autocomplete="off" spellcheck="false" value><!----></form><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="主页"><span class="font-icon icon iconfont icon-home" style=""></span>主页<!----></a></div><div class="nav-item hide-in-mobile"><a href="/front/Vue/" class="nav-link" aria-label="前端"><span class="font-icon icon iconfont icon-javascript" style=""></span>前端<!----></a></div><div class="nav-item hide-in-mobile"><a href="/Java/" class="nav-link" aria-label="后端"><span class="font-icon icon iconfont icon-java" style=""></span>后端<!----></a></div><div class="nav-item hide-in-mobile"><a href="/devops/" class="nav-link" aria-label="运维"><span class="font-icon icon iconfont icon-centos" style=""></span>运维<!----></a></div><div class="nav-item hide-in-mobile"><a href="/mysql/" class="nav-link" aria-label="Mysql"><span class="font-icon icon iconfont icon-more" style=""></span>Mysql<!----></a></div><div class="nav-item hide-in-mobile"><a href="/redis/" class="nav-link" aria-label="Redis"><span class="font-icon icon iconfont icon-launch" style=""></span>Redis<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="项目实战"><span class="title"><span class="font-icon icon iconfont icon-hot" style=""></span>项目实战</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/study-project/school/" class="nav-link active" aria-label="谷粒学院"><!---->谷粒学院<!----></a></li><li class="dropdown-item"><a href="/study-project/mall/" class="nav-link" aria-label="谷粒商城"><!---->谷粒商城<!----></a></li><li class="dropdown-item"><a href="/study-project/evaluate/" class="nav-link" aria-label="黑马点评"><!---->黑马点评<!----></a></li><li class="dropdown-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#" class="router-link-active router-link-exact-active nav-link" aria-label="探花交友"><!---->探花交友<!----></a></li><li class="dropdown-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#" class="router-link-active router-link-exact-active nav-link" aria-label="黑马头条"><!---->黑马头条<!----></a></li><li class="dropdown-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#" class="router-link-active router-link-exact-active nav-link" aria-label="品达物流TMS"><!---->品达物流TMS<!----></a></li><li class="dropdown-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#" class="router-link-active router-link-exact-active nav-link" aria-label="智牛股"><!---->智牛股<!----></a></li><li class="dropdown-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#" class="router-link-active router-link-exact-active nav-link" aria-label="亿可控"><!---->亿可控<!----></a></li><li class="dropdown-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#" class="router-link-active router-link-exact-active nav-link" aria-label="开源项目"><!---->开源项目<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="学习中遇到的问题"><span class="title"><span class="font-icon icon iconfont icon-linux" style=""></span>学习中遇到的问题</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/mac/idea.html" class="nav-link" aria-label="MAC使用IDEA小技巧"><!---->MAC使用IDEA小技巧<!----></a></li><li class="dropdown-item"><a href="/mac/linux.html" class="nav-link" aria-label="Linux使用小技巧"><!---->Linux使用小技巧<!----></a></li></ul></button></div></div></nav><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%871.html" class="nav-link sidebar-link sidebar-page" aria-label="基础开发"><!---->基础开发<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="技术整合"><!---->技术整合<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#整合nuxt" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="整合NUXT"><!---->整合NUXT<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#什么是nuxt" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="什么是NUXT？"><!---->什么是NUXT？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#安装nuxt" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="安装NUXT"><!---->安装NUXT<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#幻灯片插件" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="幻灯片插件"><!---->幻灯片插件<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#页面布局" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="页面布局"><!---->页面布局<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#路由" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="路由"><!---->路由<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#封装axios" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="封装axios"><!---->封装axios<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#整合redis" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="整合Redis"><!---->整合Redis<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#树状图整合" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="树状图整合"><!---->树状图整合<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#banner整合" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="banner整合"><!---->banner整合<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#表格树状图缓存" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="表格树状图缓存"><!---->表格树状图缓存<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#注意点" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="注意点"><!---->注意点<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#整合jwt-json-web-token" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="整合JWT(JSON Web Token)"><!---->整合JWT(JSON Web Token)<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#用户登录业务介绍" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="用户登录业务介绍"><!---->用户登录业务介绍<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#传统用户身份验证" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="传统用户身份验证"><!---->传统用户身份验证<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#解决方案" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="解决方案"><!---->解决方案<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#jwt令牌" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="JWT令牌"><!---->JWT令牌<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#jwt的原则" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="JWT的原则"><!---->JWT的原则<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#整合" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="整合"><!---->整合<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#整合腾讯云短信服务" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="整合腾讯云短信服务"><!---->整合腾讯云短信服务<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#后端编码" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="后端编码"><!---->后端编码<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#前端编码" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="前端编码"><!---->前端编码<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#微信扫描登录" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="微信扫描登录"><!---->微信扫描登录<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#oauth2" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="OAuth2"><!---->OAuth2<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#开发流程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="开发流程"><!---->开发流程<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#整合微信支付" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="整合微信支付"><!---->整合微信支付<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#后端开发" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="后端开发"><!---->后端开发<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#开发微信支付接口" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="开发微信支付接口"><!---->开发微信支付接口<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#前端开发" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="前端开发"><!---->前端开发<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#整合统计分析" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="整合统计分析"><!---->整合统计分析<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#统计某一天的注册人数" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="统计某一天的注册人数"><!---->统计某一天的注册人数<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#实现服务调用" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="实现服务调用"><!---->实现服务调用<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#添加定时任务" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="添加定时任务"><!---->添加定时任务<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#统计数据图表显示" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="统计数据图表显示"><!---->统计数据图表显示<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#样式调整" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="样式调整"><!---->样式调整<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#整合gateway网关" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="整合Gateway网关"><!---->整合Gateway网关<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#网关相关配置" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="网关相关配置"><!---->网关相关配置<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#全局filter" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="全局Filter"><!---->全局Filter<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#自定义异常处理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="自定义异常处理"><!---->自定义异常处理<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#整合配置中心" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="整合配置中心"><!---->整合配置中心<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#为什么需要配置中心" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="为什么需要配置中心"><!---->为什么需要配置中心<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#jar包和war包区别及理解" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="jar包和war包区别及理解"><!---->jar包和war包区别及理解<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#读取配置文件" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="读取配置文件"><!---->读取配置文件<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#多配置文件加载" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="多配置文件加载"><!---->多配置文件加载<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#整合jenkins" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="整合Jenkins"><!---->整合Jenkins<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#代码上传到码云" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="代码上传到码云"><!---->代码上传到码云<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#环境配置" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="环境配置"><!---->环境配置<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#构建作业" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="构建作业"><!---->构建作业<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/study-project/school/%E6%80%BB%E7%BB%93%E7%AF%87.html" class="nav-link sidebar-link sidebar-page" aria-label="面试总结"><!---->面试总结<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->技术整合</h1><div class="page-info"><span class="author-info" aria-label="Author🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://xiaocaicoding.cn" target="_blank" rel="noopener noreferrer">xiaocai</a></span><span property="author" content="xiaocai"></span></span><!----><!----><!----><!----><span class="reading-time-info" aria-label="Reading Time⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 27 min</span><meta property="timeRequired" content="PT27M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">On This Page</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#整合nuxt" class="router-link-active router-link-exact-active toc-link level2">整合NUXT</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#什么是nuxt" class="router-link-active router-link-exact-active toc-link level3">什么是NUXT？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#安装nuxt" class="router-link-active router-link-exact-active toc-link level3">安装NUXT</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#幻灯片插件" class="router-link-active router-link-exact-active toc-link level3">幻灯片插件</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#页面布局" class="router-link-active router-link-exact-active toc-link level3">页面布局</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#路由" class="router-link-active router-link-exact-active toc-link level3">路由</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#封装axios" class="router-link-active router-link-exact-active toc-link level3">封装axios</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#整合redis" class="router-link-active router-link-exact-active toc-link level2">整合Redis</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#树状图整合" class="router-link-active router-link-exact-active toc-link level3">树状图整合</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#banner整合" class="router-link-active router-link-exact-active toc-link level3">banner整合</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#表格树状图缓存" class="router-link-active router-link-exact-active toc-link level3">表格树状图缓存</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#注意点" class="router-link-active router-link-exact-active toc-link level3">注意点</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#整合jwt-json-web-token" class="router-link-active router-link-exact-active toc-link level2">整合JWT(JSON Web Token)</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#用户登录业务介绍" class="router-link-active router-link-exact-active toc-link level3">用户登录业务介绍</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#传统用户身份验证" class="router-link-active router-link-exact-active toc-link level3">传统用户身份验证</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#解决方案" class="router-link-active router-link-exact-active toc-link level3">解决方案</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#jwt令牌" class="router-link-active router-link-exact-active toc-link level3">JWT令牌</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#jwt的原则" class="router-link-active router-link-exact-active toc-link level3">JWT的原则</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#整合" class="router-link-active router-link-exact-active toc-link level3">整合</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#整合腾讯云短信服务" class="router-link-active router-link-exact-active toc-link level2">整合腾讯云短信服务</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#后端编码" class="router-link-active router-link-exact-active toc-link level3">后端编码</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#前端编码" class="router-link-active router-link-exact-active toc-link level3">前端编码</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#微信扫描登录" class="router-link-active router-link-exact-active toc-link level2">微信扫描登录</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#oauth2" class="router-link-active router-link-exact-active toc-link level3">OAuth2</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#开发流程" class="router-link-active router-link-exact-active toc-link level3">开发流程</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#整合微信支付" class="router-link-active router-link-exact-active toc-link level2">整合微信支付</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#后端开发" class="router-link-active router-link-exact-active toc-link level3">后端开发</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#开发微信支付接口" class="router-link-active router-link-exact-active toc-link level3">开发微信支付接口</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#前端开发" class="router-link-active router-link-exact-active toc-link level3">前端开发</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#整合统计分析" class="router-link-active router-link-exact-active toc-link level2">整合统计分析</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#统计某一天的注册人数" class="router-link-active router-link-exact-active toc-link level3">统计某一天的注册人数</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#实现服务调用" class="router-link-active router-link-exact-active toc-link level3">实现服务调用</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#添加定时任务" class="router-link-active router-link-exact-active toc-link level3">添加定时任务</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#统计数据图表显示" class="router-link-active router-link-exact-active toc-link level3">统计数据图表显示</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#样式调整" class="router-link-active router-link-exact-active toc-link level3">样式调整</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#整合gateway网关" class="router-link-active router-link-exact-active toc-link level2">整合Gateway网关</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#网关相关配置" class="router-link-active router-link-exact-active toc-link level3">网关相关配置</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#全局filter" class="router-link-active router-link-exact-active toc-link level3">全局Filter</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#自定义异常处理" class="router-link-active router-link-exact-active toc-link level3">自定义异常处理</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#整合配置中心" class="router-link-active router-link-exact-active toc-link level2">整合配置中心</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#为什么需要配置中心" class="router-link-active router-link-exact-active toc-link level3">为什么需要配置中心</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#jar包和war包区别及理解" class="router-link-active router-link-exact-active toc-link level3">jar包和war包区别及理解</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#读取配置文件" class="router-link-active router-link-exact-active toc-link level3">读取配置文件</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#多配置文件加载" class="router-link-active router-link-exact-active toc-link level3">多配置文件加载</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#整合jenkins" class="router-link-active router-link-exact-active toc-link level2">整合Jenkins</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#代码上传到码云" class="router-link-active router-link-exact-active toc-link level3">代码上传到码云</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#环境配置" class="router-link-active router-link-exact-active toc-link level3">环境配置</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%872.html#构建作业" class="router-link-active router-link-exact-active toc-link level3">构建作业</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="技术整合" tabindex="-1"><a class="header-anchor" href="#技术整合" aria-hidden="true">#</a> 技术整合</h1><h2 id="整合nuxt" tabindex="-1"><a class="header-anchor" href="#整合nuxt" aria-hidden="true">#</a> 整合NUXT</h2><h3 id="什么是nuxt" tabindex="-1"><a class="header-anchor" href="#什么是nuxt" aria-hidden="true">#</a> 什么是NUXT？</h3><blockquote><p>一种服务端渲染技术</p></blockquote><p><strong>1、什么是服务端渲染</strong></p><p>服务端渲染又称SSR (Server Side Render)是在服务端完成页面的内容，而不是在客户端通过AJAX获取数据。</p><p>服务器端渲染(SSR)的优势主要在于：<strong>更好的 SEO</strong>，由于搜索引擎爬虫抓取工具可以直接查看完全渲染的页面。</p><p>如果你的应用程序初始展示 loading 菊花图，然后通过 Ajax 获取内容，抓取工具并不会等待异步完成后再进行页面内容的抓取。也就是说，如果 SEO 对你的站点至关重要，而你的页面又是异步获取内容，则你可能需要服务器端渲染(SSR)解决此问题。</p><p>另外，使用服务器端渲染，我们可以获得更快的内容到达时间(time-to-content)，无需等待所有的 JavaScript 都完成下载并执行，产生更好的用户体验，对于那些「内容到达时间(time-to-content)与转化率直接相关」的应用程序而言，服务器端渲染(SSR)至关重要。</p><p><strong>2、什么是NUXT</strong></p><p>Nuxt.js 是一个基于 Vue.js 的轻量级应用框架,可用来创建服务端渲染 (SSR) 应用,也可充当静态站点引擎生成静态站点应用,具有优雅的代码结构分层和热加载等特性。</p><p>官网网站：</p><p><a href="https://zh.nuxtjs.org/" target="_blank" rel="noopener noreferrer">https://zh.nuxtjs.org/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="安装nuxt" tabindex="-1"><a class="header-anchor" href="#安装nuxt" aria-hidden="true">#</a> 安装NUXT</h3><p><strong>1、下载压缩包</strong></p><p><a href="https://github.com/nuxt-community/starter-template/archive/master.zip" target="_blank" rel="noopener noreferrer">https://github.com/nuxt-community/starter-template/archive/master.zip<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><strong>2、解压</strong></p><p>将template中的内容复制到 guli</p><p><strong>3、安装ESLint</strong></p><p>将guli-admin项目下的.eslintrc.js配置文件复制到当前项目下</p><p><strong>4、修改package.json</strong></p><p>name、description、author（必须修改这里，否则项目无法安装）</p><p><strong>6、在命令提示终端中进入项目目录</strong></p><p><strong>7、安装依赖</strong></p><p>npm install</p><p><strong>8、测试运行</strong></p><p>npm run dev</p><p><strong>9、NUXT目录结构</strong></p><p>（1）资源目录 assets</p><p>用于组织未编译的静态资源如 LESS、SASS 或 JavaScript。</p><p>（2）组件目录 components</p><p>用于组织应用的 Vue.js 组件。Nuxt.js 不会扩展增强该目录下 Vue.js 组件，即这些组件不会像页面组件那样有 asyncData 方法的特性。</p><p>（3）布局目录 layouts</p><p>用于组织应用的布局组件。</p><p>（4）页面目录 pages</p><p>用于组织应用的路由及视图。Nuxt.js 框架读取该目录下所有的 .vue 文件并自动生成对应的路由配置。</p><p>（5）插件目录 plugins</p><p>用于组织那些需要在 根vue.js应用 实例化之前需要运行的 Javascript 插件。</p><p>（6）nuxt.config.js 文件</p><p>nuxt.config.js 文件用于组织Nuxt.js 应用的个性化配置，以便覆盖默认配置。</p><h3 id="幻灯片插件" tabindex="-1"><a class="header-anchor" href="#幻灯片插件" aria-hidden="true">#</a> 幻灯片插件</h3><p><strong>1、安装插件</strong></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>
npm install vue-awesome-swiper

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>2、配置插件</strong></p><p>在 plugins 文件夹下新建文件 nuxt-swiper-plugin.js，内容是</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>
import Vue from &#39;vue&#39;

import VueAwesomeSwiper from &#39;vue-awesome-swiper/dist/ssr&#39;

Vue.use(VueAwesomeSwiper)

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在 nuxt.config.js 文件中配置插件</p><p>将 plugins 和 css节点 复制到 module.exports节点下</p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220511152146044.png" alt="image-20220511152146044" tabindex="0" loading="lazy"><figcaption>image-20220511152146044</figcaption></figure><h3 id="页面布局" tabindex="-1"><a class="header-anchor" href="#页面布局" aria-hidden="true">#</a> 页面布局</h3><p><strong>1、复制静态资源</strong></p><p>将静态原型中的css、img、js、photo目录拷贝至assets目录下</p><p>将favicon.ico复制到static目录下</p><p><strong>2、定义布局</strong></p><p>我们可以把页头和页尾提取出来，形成布局页</p><p>修改layouts目录下default.vue，从静态页面中复制首页，修改了原始文件中的资源路径为~/assets/，将主内容区域的内容替换成<code>&lt;nuxt /&gt;</code></p><p>内容如下：</p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220511152317672.png" alt="image-20220511152317672" tabindex="0" loading="lazy"><figcaption>image-20220511152317672</figcaption></figure><p><strong>3、定义首页面</strong></p><p>修改pages/index.vue：</p><p>修改了原始文件中的资源路径为~/assets/</p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220511152520864.png" alt="image-20220511152520864" tabindex="0" loading="lazy"><figcaption>image-20220511152520864</figcaption></figure><h3 id="路由" tabindex="-1"><a class="header-anchor" href="#路由" aria-hidden="true">#</a> 路由</h3><p><strong>1、固定路由</strong></p><p>点击，跳转。跳转的路径是固定的</p><p><strong>2、动态路由</strong></p><p>如果我们需要根据id查询一条记录，就需要使用动态路由。NUXT的动态路由是以下划线开头的vue文件，参数名为下划线后边的文件名</p><p>在pages下的course目录下创建_id.vue</p><h3 id="封装axios" tabindex="-1"><a class="header-anchor" href="#封装axios" aria-hidden="true">#</a> 封装axios</h3><blockquote><p>为了更好的操作ajax，我们用axios来操作</p></blockquote><blockquote></blockquote><blockquote><p>我们参考guli-admin将axios操作封装起来</p></blockquote><p>下载axios ，使用命令 <strong>npm install axios</strong></p><p>创建utils文件夹，utils下创建request.js</p><div class="language-react line-numbers-mode" data-ext="react"><pre class="language-react"><code>
import axios from &#39;axios&#39;

// 创建axios实例

const service = axios.create({

  baseURL: &#39;http://localhost:8201&#39;, // api的base_url

  timeout: 20000 // 请求超时时间

})

export default service

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>整合教师页面和课程页面</strong></p><p><strong>就是复制两个vue页面</strong></p><p><strong>然后分别定义两个动态路由页面</strong></p><h2 id="整合redis" tabindex="-1"><a class="header-anchor" href="#整合redis" aria-hidden="true">#</a> 整合Redis</h2><blockquote><p>这里整合的redis实例是尚荣宝项目的，给树状图做缓存</p><p>下面在整合一个前端的banner轮播图</p></blockquote><h3 id="树状图整合" tabindex="-1"><a class="header-anchor" href="#树状图整合" aria-hidden="true">#</a> 树状图整合</h3><p><strong>1、centos上运行redis服务器</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220508212707013.png" alt="image-20220508212707013" tabindex="0" loading="lazy"><figcaption>image-20220508212707013</figcaption></figure><p><strong>2、目前数据库是空的</strong></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>127.0.0.1:6379&gt; keys *
(empty array)
127.0.0.1:6379&gt; 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>3、在查询接口实现类中通过redistemplate加上redis缓存</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220508212645197.png" alt="image-20220508212645197" tabindex="0" loading="lazy"><figcaption>image-20220508212645197</figcaption></figure><p><strong>4、访问前端项目，看redis中是否会加上key和value</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220508213916996.png" alt="image-20220508213916996" tabindex="0" loading="lazy"><figcaption>image-20220508213916996</figcaption></figure><p><strong>5、测试</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220508214318344.png" alt="image-20220508214318344" tabindex="0" loading="lazy"><figcaption>image-20220508214318344</figcaption></figure><h3 id="banner整合" tabindex="-1"><a class="header-anchor" href="#banner整合" aria-hidden="true">#</a> banner整合</h3><p>第二种整合方式采用注解形式，注解形式的整合需要redis的配置文件</p><p>配置文件的写法是固定的，如下：</p><p><strong>一、配置类</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableCaching</span>  <span class="token comment">//开启缓存</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisConfig</span> <span class="token keyword">extends</span> <span class="token class-name">CachingConfigurationSelector</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">redisTemplate</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> factory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RedisSerializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> redisSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Jackson2JsonRedisSerializer</span> jackson2JsonRedisSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jackson2JsonRedisSerializer</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ObjectMapper</span> om <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        om<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span><span class="token class-name">PropertyAccessor</span><span class="token punctuation">.</span><span class="token constant">ALL</span><span class="token punctuation">,</span> <span class="token class-name">JsonAutoDetect<span class="token punctuation">.</span>Visibility</span><span class="token punctuation">.</span><span class="token constant">ANY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        om<span class="token punctuation">.</span><span class="token function">activateDefaultTyping</span><span class="token punctuation">(</span><span class="token class-name">LaissezFaireSubTypeValidator</span><span class="token punctuation">.</span>instance<span class="token punctuation">,</span><span class="token class-name">ObjectMapper<span class="token punctuation">.</span>DefaultTyping</span><span class="token punctuation">.</span><span class="token constant">NON_FINAL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jackson2JsonRedisSerializer<span class="token punctuation">.</span><span class="token function">setObjectMapper</span><span class="token punctuation">(</span>om<span class="token punctuation">)</span><span class="token punctuation">;</span>
        template<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>factory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//key序列化方式</span>
        template<span class="token punctuation">.</span><span class="token function">setKeySerializer</span><span class="token punctuation">(</span>redisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//value序列化</span>
        template<span class="token punctuation">.</span><span class="token function">setValueSerializer</span><span class="token punctuation">(</span>jackson2JsonRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//value hashmap序列化</span>
        template<span class="token punctuation">.</span><span class="token function">setHashValueSerializer</span><span class="token punctuation">(</span>jackson2JsonRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> template<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">CacheManager</span> <span class="token function">cacheManager</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> factory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">RedisSerializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> redisSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Jackson2JsonRedisSerializer</span> jackson2JsonRedisSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jackson2JsonRedisSerializer</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//解决查询缓存转换异常的问题</span>
        <span class="token class-name">ObjectMapper</span> om <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        om<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span><span class="token class-name">PropertyAccessor</span><span class="token punctuation">.</span><span class="token constant">ALL</span><span class="token punctuation">,</span> <span class="token class-name">JsonAutoDetect<span class="token punctuation">.</span>Visibility</span><span class="token punctuation">.</span><span class="token constant">ANY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        om<span class="token punctuation">.</span><span class="token function">activateDefaultTyping</span><span class="token punctuation">(</span><span class="token class-name">LaissezFaireSubTypeValidator</span><span class="token punctuation">.</span>instance<span class="token punctuation">,</span><span class="token class-name">ObjectMapper<span class="token punctuation">.</span>DefaultTyping</span><span class="token punctuation">.</span><span class="token constant">NON_FINAL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jackson2JsonRedisSerializer<span class="token punctuation">.</span><span class="token function">setObjectMapper</span><span class="token punctuation">(</span>om<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 配置序列化（解决乱码的问题）,过期时间600秒</span>
        <span class="token class-name">RedisCacheConfiguration</span> config <span class="token operator">=</span> <span class="token class-name">RedisCacheConfiguration</span><span class="token punctuation">.</span><span class="token function">defaultCacheConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">entryTtl</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">serializeKeysWith</span><span class="token punctuation">(</span><span class="token class-name">RedisSerializationContext<span class="token punctuation">.</span>SerializationPair</span><span class="token punctuation">.</span><span class="token function">fromSerializer</span><span class="token punctuation">(</span>redisSerializer<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">serializeValuesWith</span><span class="token punctuation">(</span><span class="token class-name">RedisSerializationContext<span class="token punctuation">.</span>SerializationPair</span><span class="token punctuation">.</span><span class="token function">fromSerializer</span><span class="token punctuation">(</span>jackson2JsonRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">disableCachingNullValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RedisCacheManager</span> cacheManager <span class="token operator">=</span> <span class="token class-name">RedisCacheManager</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span>factory<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">cacheDefaults</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> cacheManager<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>二、配置文件</strong></p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment"># 服务端口</span>
<span class="token key attr-name">server.port</span><span class="token punctuation">=</span><span class="token value attr-value">8004</span>
<span class="token comment"># 服务名</span>
<span class="token key attr-name">spring.application.name</span><span class="token punctuation">=</span><span class="token value attr-value">service-cms</span>
<span class="token key attr-name">spring.cloud.nacos.discovery.server-addr</span><span class="token punctuation">=</span><span class="token value attr-value">127.0.0.1:8848</span>

<span class="token comment"># mysql数据库连接</span>
<span class="token key attr-name">spring.datasource.driver-class-name</span><span class="token punctuation">=</span><span class="token value attr-value">com.mysql.cj.jdbc.Driver</span>
<span class="token key attr-name">spring.datasource.url</span><span class="token punctuation">=</span><span class="token value attr-value">jdbc:mysql://localhost:3306/guli?serverTimezone=GMT%2B8</span>
<span class="token key attr-name">spring.datasource.username</span><span class="token punctuation">=</span><span class="token value attr-value">root</span>
<span class="token key attr-name">spring.datasource.password</span><span class="token punctuation">=</span><span class="token value attr-value">root</span>

<span class="token comment">#返回json的全局时间格式</span>
<span class="token key attr-name">spring.jackson.date-format</span><span class="token punctuation">=</span><span class="token value attr-value">yyyy-MM-dd HH:mm:ss</span>
<span class="token key attr-name">spring.jackson.time-zone</span><span class="token punctuation">=</span><span class="token value attr-value">GMT+8</span>

<span class="token comment">#配置mapper xml文件的路径</span>
<span class="token key attr-name">mybatis-plus.mapper-locations</span><span class="token punctuation">=</span><span class="token value attr-value">classpath:com/caq/educms/mapper/xml/*.xml</span>

<span class="token key attr-name">spring.redis.host</span><span class="token punctuation">=</span><span class="token value attr-value">172.20.10.9</span>
<span class="token key attr-name">spring.redis.port</span><span class="token punctuation">=</span><span class="token value attr-value">6379</span>
<span class="token key attr-name">spring.redis.database</span><span class="token punctuation">=</span> <span class="token value attr-value">0</span>
<span class="token key attr-name">spring.redis.timeout</span><span class="token punctuation">=</span><span class="token value attr-value">1800000</span>

<span class="token key attr-name">spring.redis.lettuce.pool.max-active</span><span class="token punctuation">=</span><span class="token value attr-value">20</span>
<span class="token key attr-name">spring.redis.lettuce.pool.max-wait</span><span class="token punctuation">=</span><span class="token value attr-value">-1</span>
<span class="token comment">#最大阻塞等待时间(负数表示没限制)</span>
<span class="token key attr-name">spring.redis.lettuce.pool.max-idle</span><span class="token punctuation">=</span><span class="token value attr-value">5</span>
<span class="token key attr-name">spring.redis.lettuce.pool.min-idle</span><span class="token punctuation">=</span><span class="token value attr-value">0</span>

<span class="token comment">#mybatis日志</span>
<span class="token key attr-name">mybatis-plus.configuration.log-impl</span><span class="token punctuation">=</span><span class="token value attr-value">org.apache.ibatis.logging.stdout.StdOutImpl</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>三、修改实现类</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CrmBannerServiceImpl</span> <span class="token keyword">extends</span> <span class="token class-name">ServiceImpl</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CrmBannerMapper</span><span class="token punctuation">,</span> <span class="token class-name">CrmBanner</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">CrmBannerService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Cacheable</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;banner&quot;</span><span class="token punctuation">,</span>key <span class="token operator">=</span> <span class="token string">&quot;&#39;selectIndexList&#39;&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CrmBanner</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectAllBanner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">//根据id进行降序排序，显示排列之后的前两条记录</span>
        <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CrmBanner</span><span class="token punctuation">&gt;</span></span> queryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        queryWrapper<span class="token punctuation">.</span><span class="token function">orderByDesc</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//拼接sql语句</span>
        queryWrapper<span class="token punctuation">.</span><span class="token function">last</span><span class="token punctuation">(</span><span class="token string">&quot;limit 2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CrmBanner</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> baseMapper<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> list<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>四、测试</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220511201420247.png" alt="image-20220511201420247" tabindex="0" loading="lazy"><figcaption>image-20220511201420247</figcaption></figure><h3 id="表格树状图缓存" tabindex="-1"><a class="header-anchor" href="#表格树状图缓存" aria-hidden="true">#</a> 表格树状图缓存</h3><p><strong>1.导入依赖</strong></p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!-- redis --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- spring2.X集成redis所需common-pool2--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.commons<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>commons-pool2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>2.reids配置类</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableCaching</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisConfig</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * 自定义key规则
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">KeyGenerator</span> <span class="token function">keyGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">KeyGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">generate</span><span class="token punctuation">(</span><span class="token class-name">Object</span> target<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">StringBuilder</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Object</span> obj <span class="token operator">:</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">return</span> sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * 设置RedisTemplate规则
     * <span class="token keyword">@param</span> <span class="token parameter">redisConnectionFactory</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">redisTemplate</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> redisConnectionFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> redisTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        redisTemplate<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>redisConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Jackson2JsonRedisSerializer</span> jackson2JsonRedisSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jackson2JsonRedisSerializer</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//解决查询缓存转换异常的问题</span>
        <span class="token class-name">ObjectMapper</span> om <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 指定要序列化的域，field,get和set,以及修饰符范围，ANY是都有包括private和public</span>
        om<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span><span class="token class-name">PropertyAccessor</span><span class="token punctuation">.</span><span class="token constant">ALL</span><span class="token punctuation">,</span> <span class="token class-name">JsonAutoDetect<span class="token punctuation">.</span>Visibility</span><span class="token punctuation">.</span><span class="token constant">ANY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 指定序列化输入的类型，类必须是非final修饰的，final修饰的类，比如String,Integer等会跑出异常</span>
        om<span class="token punctuation">.</span><span class="token function">enableDefaultTyping</span><span class="token punctuation">(</span><span class="token class-name">ObjectMapper<span class="token punctuation">.</span>DefaultTyping</span><span class="token punctuation">.</span><span class="token constant">NON_FINAL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jackson2JsonRedisSerializer<span class="token punctuation">.</span><span class="token function">setObjectMapper</span><span class="token punctuation">(</span>om<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//序列号key value</span>
        redisTemplate<span class="token punctuation">.</span><span class="token function">setKeySerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        redisTemplate<span class="token punctuation">.</span><span class="token function">setValueSerializer</span><span class="token punctuation">(</span>jackson2JsonRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        redisTemplate<span class="token punctuation">.</span><span class="token function">setHashKeySerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        redisTemplate<span class="token punctuation">.</span><span class="token function">setHashValueSerializer</span><span class="token punctuation">(</span>jackson2JsonRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>

        redisTemplate<span class="token punctuation">.</span><span class="token function">afterPropertiesSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * 设置CacheManager缓存规则
     * <span class="token keyword">@param</span> <span class="token parameter">factory</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">CacheManager</span> <span class="token function">cacheManager</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> factory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">RedisSerializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> redisSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Jackson2JsonRedisSerializer</span> jackson2JsonRedisSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jackson2JsonRedisSerializer</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//解决查询缓存转换异常的问题</span>
        <span class="token class-name">ObjectMapper</span> om <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        om<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span><span class="token class-name">PropertyAccessor</span><span class="token punctuation">.</span><span class="token constant">ALL</span><span class="token punctuation">,</span> <span class="token class-name">JsonAutoDetect<span class="token punctuation">.</span>Visibility</span><span class="token punctuation">.</span><span class="token constant">ANY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        om<span class="token punctuation">.</span><span class="token function">enableDefaultTyping</span><span class="token punctuation">(</span><span class="token class-name">ObjectMapper<span class="token punctuation">.</span>DefaultTyping</span><span class="token punctuation">.</span><span class="token constant">NON_FINAL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jackson2JsonRedisSerializer<span class="token punctuation">.</span><span class="token function">setObjectMapper</span><span class="token punctuation">(</span>om<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 配置序列化（解决乱码的问题）,过期时间600秒</span>
        <span class="token class-name">RedisCacheConfiguration</span> config <span class="token operator">=</span> <span class="token class-name">RedisCacheConfiguration</span><span class="token punctuation">.</span><span class="token function">defaultCacheConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">entryTtl</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">serializeKeysWith</span><span class="token punctuation">(</span><span class="token class-name">RedisSerializationContext<span class="token punctuation">.</span>SerializationPair</span><span class="token punctuation">.</span><span class="token function">fromSerializer</span><span class="token punctuation">(</span>redisSerializer<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">serializeValuesWith</span><span class="token punctuation">(</span><span class="token class-name">RedisSerializationContext<span class="token punctuation">.</span>SerializationPair</span><span class="token punctuation">.</span><span class="token function">fromSerializer</span><span class="token punctuation">(</span>jackson2JsonRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">disableCachingNullValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">RedisCacheManager</span> cacheManager <span class="token operator">=</span> <span class="token class-name">RedisCacheManager</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span>factory<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">cacheDefaults</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> cacheManager<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>3.通过Spring Cache 进行缓存</strong></p><p><strong>缓存@Cacheable</strong></p><p>根据方法对其返回结果进行缓存，下次请求时，如果缓存存在，则直接读取缓存数据返回；如果缓存不存在，则执行方法，并把返回的结果存入缓存中。一般用在查询方法上。</p><table><thead><tr><th>属性/方法名</th><th>解释</th></tr></thead><tbody><tr><td>value</td><td>缓存名，必填，它指定了你的缓存存放在哪块命名空间</td></tr><tr><td>cacheNames</td><td>与 value 差不多，二选一即可</td></tr><tr><td>key</td><td>可选属性，可以使用 SpEL 标签自定义缓存的key</td></tr></tbody></table><p><strong>缓存@CachePut</strong></p><p>使用该注解标志的方法，每次都会执行，并将结果存入指定的缓存中。其他方法可以直接从响应的缓存中读取缓存数据，而不需要再去查询数据库。一般用在新增方法上。</p><p>查看源码，属性值如下：</p><table><thead><tr><th>属性/方法名</th><th>解释</th></tr></thead><tbody><tr><td>value</td><td>缓存名，必填，它指定了你的缓存存放在哪块命名空间</td></tr><tr><td>cacheNames</td><td>与 value 差不多，二选一即可</td></tr><tr><td>key</td><td>可选属性，可以使用 SpEL 标签自定义缓存的key</td></tr></tbody></table><p><strong>缓存@CacheEvict</strong></p><p>使用该注解标志的方法，会清空指定的缓存。一般用在更新或者删除方法上</p><p>查看源码，属性值如下：</p><table><thead><tr><th>属性/方法名</th><th>解释</th></tr></thead><tbody><tr><td>value</td><td>缓存名，必填，它指定了你的缓存存放在哪块命名空间</td></tr><tr><td>cacheNames</td><td>与 value 差不多，二选一即可</td></tr><tr><td>key</td><td>可选属性，可以使用 SpEL 标签自定义缓存的key</td></tr><tr><td>allEntries</td><td>是否清空所有缓存，默认为 false。如果指定为 true，则方法调用后将立即清空所有的缓存</td></tr><tr><td>beforeInvocation</td><td>是否在方法执行前就清空，默认为 false。如果指定为 true，则在方法执行前就会清空缓存</td></tr></tbody></table><p><strong>4.应用</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220717221859062.png" alt="image-20220717221859062" tabindex="0" loading="lazy"><figcaption>image-20220717221859062</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220717221940092.png" alt="image-20220717221940092" tabindex="0" loading="lazy"><figcaption>image-20220717221940092</figcaption></figure><h3 id="注意点" tabindex="-1"><a class="header-anchor" href="#注意点" aria-hidden="true">#</a> 注意点</h3><blockquote><p>redis主要是配置文件，对配置文件的详解可看如下文章</p><p><a href="https://cloud.tencent.com/developer/article/1947475" target="_blank" rel="noopener noreferrer">Redis配置文件详解 - 云+社区 - 腾讯云 (tencent.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><p><strong>（1）关闭liunx防火墙</strong></p><p>（2）找到redis配置文件， 注释一行配置</p><p>默认情况这个bind不改的话只能接受本机的访问请求</p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220521200723885.png" alt="image-20220521200723885" tabindex="0" loading="lazy"><figcaption>image-20220521200723885</figcaption></figure><p><strong>修改</strong> <strong>protected-mode yes</strong></p><p><strong>改为protected-mode no</strong></p><blockquote><p>关掉redis的bind项和没设置redis密码的时候，能让redis接受其他主机的响应</p></blockquote><h2 id="整合jwt-json-web-token" tabindex="-1"><a class="header-anchor" href="#整合jwt-json-web-token" aria-hidden="true">#</a> 整合JWT(JSON Web Token)</h2><h3 id="用户登录业务介绍" tabindex="-1"><a class="header-anchor" href="#用户登录业务介绍" aria-hidden="true">#</a> 用户登录业务介绍</h3><h4 id="单一服务器模式" tabindex="-1"><a class="header-anchor" href="#单一服务器模式" aria-hidden="true">#</a> 单一服务器模式</h4><p><strong>一般情况是用户将账号密码发给服务器，服务器验证后把数据保存到session中（cookie是数据存在客户端，session是数据存在服务端）。服务端返回sessionId给客户端，客户端会把这个信息存入用户的cookie中，每次请求的从cookie中取值和服务端的保存的数据对比，确认身份。</strong></p><p>最开始学javaweb的时候，做登录都是保存到session域中，保存之后判断用户登录与否通过取session域中的数据来决定</p><p>这种登录模式只适合单一的小项目，不方便横向扩展...</p><h4 id="sso-single-sign-on-模式" tabindex="-1"><a class="header-anchor" href="#sso-single-sign-on-模式" aria-hidden="true">#</a> SSO(single sign on)模式</h4><blockquote><p>单点登录</p><p>客户端登录后，将账户密码存到认证中心，其余服务通过访问认证中心进行身份验证</p></blockquote><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220521205204424.png" alt="image-20220521205204424" tabindex="0" loading="lazy"><figcaption>image-20220521205204424</figcaption></figure><p><strong>优点 ：</strong></p><p>用户身份信息独立管理，更好的分布式管理。</p><p>可以自己扩展安全策略</p><p><strong>缺点：</strong></p><p>认证服务器访问压力较大。</p><p>token模式登录流程</p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220522155053567.png" alt="image-20220522155053567" tabindex="0" loading="lazy"><figcaption>image-20220522155053567</figcaption></figure><h4 id="sso登录三种常见的方式" tabindex="-1"><a class="header-anchor" href="#sso登录三种常见的方式" aria-hidden="true">#</a> SSO登录三种常见的方式</h4><ul><li>session广播</li><li>cookie+redis</li><li>使用token实现token</li></ul><p><strong>优点：</strong></p><p>无状态： token无状态，session有状态的</p><p>基于标准化: 你的API可以采用标准化的 JSON Web Token (JWT)</p><p><strong>缺点：</strong></p><p>占用带宽</p><p>无法在服务器端销毁</p><p><strong>注：基于微服务开发，选择token的形式相对较多，因此我使用token作为用户认证的标准</strong></p><h3 id="传统用户身份验证" tabindex="-1"><a class="header-anchor" href="#传统用户身份验证" aria-hidden="true">#</a> 传统用户身份验证</h3><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220522160031343.png" alt="image-20220522160031343" tabindex="0" loading="lazy"><figcaption>image-20220522160031343</figcaption></figure><p>Internet服务无法与用户身份验证分开。一般过程如下：</p><ol><li>用户向服务器发送用户名和密码。</li><li>验证服务器后，相关数据（如用户角色，登录时间等）将保存在当前会话中。</li><li>服务器向用户返回session_id，session信息都会写入到用户的Cookie。</li><li>用户的每个后续请求都将通过在Cookie中取出session_id传给服务器。</li><li>服务器收到session_id并对比之前保存的数据，确认用户的身份。</li></ol><p>这种模式最大的问题是，没有分布式架构，无法支持横向扩展。</p><h3 id="解决方案" tabindex="-1"><a class="header-anchor" href="#解决方案" aria-hidden="true">#</a> 解决方案</h3><ol><li>session广播</li><li>将透明令牌存入cookie，将用户身份信息存入redis</li></ol><p><strong>另外一种灵活的解决方案：</strong></p><p>使用自包含令牌，通过客户端保存数据，而服务器不保存会话数据。 JWT是这种解决方案的代表。</p><h3 id="jwt令牌" tabindex="-1"><a class="header-anchor" href="#jwt令牌" aria-hidden="true">#</a> JWT令牌</h3><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220522160432679.png" alt="image-20220522160432679" tabindex="0" loading="lazy"><figcaption>image-20220522160432679</figcaption></figure><p>典型的，一个JWT看起来如下图：</p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220522160528304.png" alt="image-20220522160528304" tabindex="0" loading="lazy"><figcaption>image-20220522160528304</figcaption></figure><p>该对象为一个很长的字符串，字符之间通过&quot;.&quot;分隔符分为三个子串。</p><p>每一个子串表示了一个功能块，总共有以下三个部分：<strong>JWT头、有效载荷和签名</strong></p><h3 id="jwt的原则" tabindex="-1"><a class="header-anchor" href="#jwt的原则" aria-hidden="true">#</a> JWT的原则</h3><p>JWT的原则是在服务器身份验证之后，将生成一个JSON对象并将其发送回用户</p><p>{ &quot;sub&quot;: &quot;1234567890&quot;, &quot;name&quot;: &quot;Jack&quot;, &quot;admin&quot;: true }</p><p>之后，<mark>当用户与服务器通信时，客户在请求中发回JSON对象。服务器仅依赖于这个JSON对象来标识用户。为了防止用户篡改数据，服务器将在生成对象时添加签名。</mark></p><p><strong>服务器不保存任何会话数据，即服务器变为无状态，使其更容易扩展。</strong></p><p>客户端接收服务器返回的JWT，将其存储在Cookie或localStorage中。</p><p>此后，客户端将在与服务器交互中都会带JWT。如果将它存储在Cookie中，就可以自动发送，但是不会跨域，因此一般是将它放入HTTP请求的Header Authorization字段中。当跨域时，也可以将JWT被放置于POST请求的数据主体中。</p><p>优势：</p><ul><li>生产的token可以包含基本信息，比如id、用户昵称、头像等信息，避免再次查库</li><li>存储在客户端，不占用服务端的内存资源</li><li>....</li></ul><h3 id="整合" tabindex="-1"><a class="header-anchor" href="#整合" aria-hidden="true">#</a> 整合</h3><p><strong>添加依赖</strong></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&lt;dependencies&gt;
    &lt;!-- JWT--&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;
        &lt;artifactId&gt;jjwt&lt;/artifactId&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>创建JWT工具类</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JwtUtils</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> <span class="token constant">EXPIRE</span> <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">24</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">APP_SECRET</span> <span class="token operator">=</span> <span class="token string">&quot;ukc8BDbRigUDaY6pZFfWus2jZWLPHO&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getJwtToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">,</span> <span class="token class-name">String</span> nickname<span class="token punctuation">)</span><span class="token punctuation">{</span>

        <span class="token class-name">String</span> <span class="token class-name">JwtToken</span> <span class="token operator">=</span> <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setHeaderParam</span><span class="token punctuation">(</span><span class="token string">&quot;typ&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;JWT&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setHeaderParam</span><span class="token punctuation">(</span><span class="token string">&quot;alg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;HS256&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span><span class="token string">&quot;guli-user&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setIssuedAt</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setExpiration</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">EXPIRE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">claim</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">claim</span><span class="token punctuation">(</span><span class="token string">&quot;nickname&quot;</span><span class="token punctuation">,</span> nickname<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">signWith</span><span class="token punctuation">(</span><span class="token class-name">SignatureAlgorithm</span><span class="token punctuation">.</span><span class="token constant">HS256</span><span class="token punctuation">,</span> <span class="token constant">APP_SECRET</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">compact</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token class-name">JwtToken</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * 判断token是否存在与有效
     * <span class="token keyword">@param</span> <span class="token parameter">jwtToken</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">checkToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> jwtToken<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>jwtToken<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">parser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setSigningKey</span><span class="token punctuation">(</span><span class="token constant">APP_SECRET</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parseClaimsJws</span><span class="token punctuation">(</span>jwtToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * 判断token是否存在与有效
     * <span class="token keyword">@param</span> <span class="token parameter">request</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">checkToken</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> jwtToken <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>jwtToken<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">parser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setSigningKey</span><span class="token punctuation">(</span><span class="token constant">APP_SECRET</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parseClaimsJws</span><span class="token punctuation">(</span>jwtToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * 根据token获取会员id
     * <span class="token keyword">@param</span> <span class="token parameter">request</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getMemberIdByJwtToken</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> jwtToken <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>jwtToken<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">Jws</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Claims</span><span class="token punctuation">&gt;</span></span> claimsJws <span class="token operator">=</span> <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">parser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setSigningKey</span><span class="token punctuation">(</span><span class="token constant">APP_SECRET</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parseClaimsJws</span><span class="token punctuation">(</span>jwtToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Claims</span> claims <span class="token operator">=</span> claimsJws<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>claims<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220512164513655.png" alt="image-20220512164513655" tabindex="0" loading="lazy"><figcaption>image-20220512164513655</figcaption></figure><h2 id="整合腾讯云短信服务" tabindex="-1"><a class="header-anchor" href="#整合腾讯云短信服务" aria-hidden="true">#</a> 整合腾讯云短信服务</h2><blockquote><p>这里整合的为腾讯云短信服务，视频中是阿里云短信。</p><p>由于阿里云短信申请不容易成功，所以我们这里用腾讯云。</p><p>看着sdk文档很容易就能整合成功~</p></blockquote><p><a href="https://cloud.tencent.com/document/product/382/43194" target="_blank" rel="noopener noreferrer">短信 Java SDK-SDK 文档-文档中心-腾讯云-腾讯云 (tencent.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="后端编码" tabindex="-1"><a class="header-anchor" href="#后端编码" aria-hidden="true">#</a> 后端编码</h3><p><strong>建模块，改pom，yml，启动类</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220522170553780.png" alt="image-20220522170553780" tabindex="0" loading="lazy"><figcaption>image-20220522170553780</figcaption></figure><p><strong>业务类</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220522171138897.png" alt="image-20220522171138897" tabindex="0" loading="lazy"><figcaption>image-20220522171138897</figcaption></figure><h3 id="前端编码" tabindex="-1"><a class="header-anchor" href="#前端编码" aria-hidden="true">#</a> 前端编码</h3><blockquote><p>主要技术点是：页面，倒计时功能</p><p>这两个功能主要是前端知识点，这里不过多展示</p></blockquote><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220522171426843.png" alt="image-20220522171426843" tabindex="0" loading="lazy"><figcaption>image-20220522171426843</figcaption></figure><p>使用完这些插件之后，其余的套路和之前整合的一样</p><p>四大步：</p><ol><li><strong>添加路由</strong></li><li><strong>点击路由显示页面</strong></li><li><strong>api文件夹创建js文件，定义后端接口地址和参数</strong></li><li><strong>创建vue页面引入js，调用方法实现功能</strong></li></ol><p>噢噢噢，这个是写后台管理系统的时候的套路对吧</p><p>前台系统也差不多的了</p><ol><li><strong>api文件夹创建js文件，定义后端接口地址和参数</strong></li><li><strong>创建vue页面引入js，调用方法实现功能</strong></li></ol><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220522171819342.png" alt="image-20220522171819342" tabindex="0" loading="lazy"><figcaption>image-20220522171819342</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220522172453985.png" alt="image-20220522172453985" tabindex="0" loading="lazy"><figcaption>image-20220522172453985</figcaption></figure><h2 id="微信扫描登录" tabindex="-1"><a class="header-anchor" href="#微信扫描登录" aria-hidden="true">#</a> 微信扫描登录</h2><h3 id="oauth2" tabindex="-1"><a class="header-anchor" href="#oauth2" aria-hidden="true">#</a> OAuth2</h3><p><a href="https://zhuanlan.zhihu.com/p/89020647" target="_blank" rel="noopener noreferrer">OAuth2.0 详解 - 知乎 (zhihu.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><strong>什么是OAuth2？</strong></p><p>OAuth 不是一个API或者服务，而是一个验证授权(Authorization)的开放标准，所有人都有基于这个标准实现自己的OAuth。</p><p><strong>为什么要有OAuth?</strong></p><p>OAuth2的出现是为了解决安全性问题，OAuth使得第三方应用对资源的访问更加安全</p><p><strong>微信扫码登录的具体流程</strong></p><p><a href="https://open.weixin.qq.com/" target="_blank" rel="noopener noreferrer">微信开放平台 (qq.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://developers.weixin.qq.com/doc/oplatform/Website_App/WeChat_Login/Wechat_Login.html" target="_blank" rel="noopener noreferrer">准备工作 | 微信开放文档 (qq.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><blockquote><p>httpclient就是不用在浏览器中输入url访问资源也能实现浏览器的过程</p></blockquote><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/730bd7bb80c05490a688330820419d9b.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>微信扫码登录流程</p><blockquote><p>来自于微信开放平台官网</p></blockquote><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>1. 第三方发起微信授权登录请求，微信用户允许授权第三方应用后，微信会拉起应用或重定向到第三方网站，并且带上授权临时票据 code 参数；
2. 通过 code 参数加上 AppID 和AppSecret等，通过 API 换取access_token；
3. 通过access_token进行接口调用，获取用户基本数据资源或帮助用户实现基本操作。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="开发流程" tabindex="-1"><a class="header-anchor" href="#开发流程" aria-hidden="true">#</a> 开发流程</h3><blockquote><p>微信扫码登录需要有商户微信信息</p><p>这里采用的是视频提供的</p></blockquote><p><strong>建模块，改pom，yml，启动类</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523134600004.png" alt="image-20220523134600004" tabindex="0" loading="lazy"><figcaption>image-20220523134600004</figcaption></figure><p>18903811085</p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523150714529.png" alt="image-20220523150714529" tabindex="0" loading="lazy"><figcaption>image-20220523150714529</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523151318757.png" alt="image-20220523151318757" tabindex="0" loading="lazy"><figcaption>image-20220523151318757</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523151443593.png" alt="image-20220523151443593" tabindex="0" loading="lazy"><figcaption>image-20220523151443593</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523152158251.png" alt="image-20220523152158251" tabindex="0" loading="lazy"><figcaption>image-20220523152158251</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523152952334.png" alt="image-20220523152952334" tabindex="0" loading="lazy"><figcaption>image-20220523152952334</figcaption></figure><p>有了access_token我们就可以通过接口来获取用户信息了，从而把用户保存到数据库中</p><p><strong>存数据库</strong></p><blockquote><p>由官网可知，请求成功后返回的结果是一个json字符串</p></blockquote><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523152459534.png" alt="image-20220523152459534" tabindex="0" loading="lazy"><figcaption>image-20220523152459534</figcaption></figure><p>如下实例：</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;access_token&quot;</span><span class="token operator">:</span><span class="token string">&quot;56_jgDYj0kFSTarb6dLk3S8v32kVFmACL7MSBlAeBllfWMtfCqmFnvaAk2jfQTnjmVJ0tt7mAwaqHQ6NUt3DNJIYq8LH7utQA6QXIwfIdC46lE&quot;</span><span class="token punctuation">,</span>
 <span class="token property">&quot;expires_in&quot;</span><span class="token operator">:</span><span class="token number">7200</span><span class="token punctuation">,</span>
 <span class="token property">&quot;refresh_token&quot;</span><span class="token operator">:</span><span class="token string">&quot;56_vQaXS1y1Fnp6zf4lZkFBDA7FNRdrkgDBPSytNMFmwdvey5oufKUIB2-7mjdIK7hjNzdD0pCAe3V7Heerszs1xiRm0jjqRufX_ddaDBviuIc&quot;</span><span class="token punctuation">,</span>
 <span class="token property">&quot;openid&quot;</span><span class="token operator">:</span><span class="token string">&quot;o3_SC501zRkVcwqQ_sbnIMcp4awU&quot;</span><span class="token punctuation">,</span>
 <span class="token property">&quot;scope&quot;</span><span class="token operator">:</span><span class="token string">&quot;snsapi_login&quot;</span><span class="token punctuation">,</span>
 <span class="token property">&quot;unionid&quot;</span><span class="token operator">:</span><span class="token string">&quot;oWgGz1FS61brgcCChgq5yO4mQuZM&quot;</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>数据库表的结构如下：</p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523152758674.png" alt="image-20220523152758674" tabindex="0" loading="lazy"><figcaption>image-20220523152758674</figcaption></figure><p>代码如下：</p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523153407411.png" alt="image-20220523153407411" tabindex="0" loading="lazy"><figcaption>image-20220523153407411</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523155403180.png" alt="image-20220523155403180" tabindex="0" loading="lazy"><figcaption>image-20220523155403180</figcaption></figure><p>前端页面不多说了，了解即可（CV）</p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523155906259.png" alt="image-20220523155906259" tabindex="0" loading="lazy"><figcaption>image-20220523155906259</figcaption></figure><h2 id="整合微信支付" tabindex="-1"><a class="header-anchor" href="#整合微信支付" aria-hidden="true">#</a> 整合微信支付</h2><blockquote><p><a href="https://pay.weixin.qq.com/wiki/doc/apiv3_partner/apis/chapter4_2_2.shtml" target="_blank" rel="noopener noreferrer">微信支付-开发者文档 (qq.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><p>需求如下：</p><ul><li>课程分为免费课程和付费课程，如果是免费课程可以直接观看，如果是付费观看的课程，用户需下单支付后才可以观看</li><li>如果是免费课程，在用户选择课程，进入到课程详情页面时候，直接显示 “立即观看”，用户点击立即观看，可以切换到播放列表进行视频播放</li><li>如果是付费课程，在用户选择课程，进入到课程详情页面时候，会显示 “立即购买”</li><li>点击“立即购买”，会生成课程的订单，跳转到订单页面</li><li>点击“去支付”，会跳转到支付页面，生成微信扫描的二维码</li><li>使用微信扫描支付后，会跳转回到课程详情页面，同时显示“立即观看”</li></ul><h3 id="后端开发" tabindex="-1"><a class="header-anchor" href="#后端开发" aria-hidden="true">#</a> 后端开发</h3><p><strong>建模块，改pom，yml，启动类</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523165907907.png" alt="image-20220523165907907" tabindex="0" loading="lazy"><figcaption>image-20220523165907907</figcaption></figure><p><strong>业务类</strong></p><blockquote><p>业务类通过代码生成器生成，在生成的基础上进行改动即可</p></blockquote><p><strong>开发创建订单接口</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523171242902.png" alt="image-20220523171242902" tabindex="0" loading="lazy"><figcaption>image-20220523171242902</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523171811637.png" alt="image-20220523171811637" tabindex="0" loading="lazy"><figcaption>image-20220523171811637</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523171946916.png" alt="image-20220523171946916" tabindex="0" loading="lazy"><figcaption>image-20220523171946916</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523172048422.png" alt="image-20220523172048422" tabindex="0" loading="lazy"><figcaption>image-20220523172048422</figcaption></figure><h3 id="开发微信支付接口" tabindex="-1"><a class="header-anchor" href="#开发微信支付接口" aria-hidden="true">#</a> 开发微信支付接口</h3><blockquote><p>这部分不复杂，其实写法也是很固定的</p></blockquote><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523200050729.png" alt="image-20220523200050729" tabindex="0" loading="lazy"><figcaption>image-20220523200050729</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523200414919.png" alt="image-20220523200414919" tabindex="0" loading="lazy"><figcaption>image-20220523200414919</figcaption></figure><p><strong>支付订单号查询</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523200447576.png" alt="image-20220523200447576" tabindex="0" loading="lazy"><figcaption>image-20220523200447576</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523200534277.png" alt="image-20220523200534277" tabindex="0" loading="lazy"><figcaption>image-20220523200534277</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523200634254.png" alt="image-20220523200634254" tabindex="0" loading="lazy"><figcaption>image-20220523200634254</figcaption></figure><h3 id="前端开发" tabindex="-1"><a class="header-anchor" href="#前端开发" aria-hidden="true">#</a> 前端开发</h3><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523200730420.png" alt="image-20220523200730420" tabindex="0" loading="lazy"><figcaption>image-20220523200730420</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523200820715.png" alt="image-20220523200820715" tabindex="0" loading="lazy"><figcaption>image-20220523200820715</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523201245363.png" alt="image-20220523201245363" tabindex="0" loading="lazy"><figcaption>image-20220523201245363</figcaption></figure><h2 id="整合统计分析" tabindex="-1"><a class="header-anchor" href="#整合统计分析" aria-hidden="true">#</a> 整合统计分析</h2><p><strong>建模块，改pom，yml，启动类</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523202254687.png" alt="image-20220523202254687" tabindex="0" loading="lazy"><figcaption>image-20220523202254687</figcaption></figure><h3 id="统计某一天的注册人数" tabindex="-1"><a class="header-anchor" href="#统计某一天的注册人数" aria-hidden="true">#</a> 统计某一天的注册人数</h3><blockquote><p>这个接口的实现定义在了service_ucenter模块中，它是用来获取某一天的注册人数的。</p><p>之后在service_statistics模块中调用service_ucenter模块中的此接口</p></blockquote><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523204810442.png" alt="image-20220523204810442" tabindex="0" loading="lazy"><figcaption>image-20220523204810442</figcaption></figure><p>具体实现如下：</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.caq.eduucenter.mapper.UcenterMemberMapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--查询某一天注册人数--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>countRegisterDay<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>java.lang.Integer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        SELECT COUNT(*) FROM ucenter_member uc
        WHERE DATE(uc.gmt_create)=#{day}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>下面这个sql的意思就是获取ucenter_member中创建日期等于2022-05-16的数量</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
	<span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 
<span class="token keyword">FROM</span>
	ucenter_member uc 
<span class="token keyword">WHERE</span>
	<span class="token keyword">DATE</span><span class="token punctuation">(</span> uc<span class="token punctuation">.</span>gmt_create <span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&#39;2022-05-16&#39;</span>
<span class="token comment">-- 获取日期时间格式里面日期部分</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实现服务调用" tabindex="-1"><a class="header-anchor" href="#实现服务调用" aria-hidden="true">#</a> 实现服务调用</h3><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523202942240.png" alt="image-20220523202942240" tabindex="0" loading="lazy"><figcaption>image-20220523202942240</figcaption></figure><p><strong>显示数据</strong></p><blockquote><p>接口这里，我们只需要得到日期和日期对应数量两个集合即可</p></blockquote><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523214957493.png" alt="image-20220523214957493" tabindex="0" loading="lazy"><figcaption>image-20220523214957493</figcaption></figure><h3 id="添加定时任务" tabindex="-1"><a class="header-anchor" href="#添加定时任务" aria-hidden="true">#</a> 添加定时任务</h3><blockquote><p><a href="http://cron.ciding.cc/" target="_blank" rel="noopener noreferrer">http://cron.ciding.cc/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>定时执行统计注册人数方法，这样就保证了统计表数据更新</p></blockquote><p><strong>日期工具类</strong></p><blockquote><p>可以指定时间执行某个操作</p><p>通过@EnableScheduling注解标注即可</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ScheduledTask</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">StatisticsDailyService</span> dailyService<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 测试
     * 每天七点到二十三点每五秒执行一次
     */</span>
    <span class="token annotation punctuation">@Scheduled</span><span class="token punctuation">(</span>cron <span class="token operator">=</span> <span class="token string">&quot;0/5 * * * * ?&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">task1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;*********++++++++++++*****执行了&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * 每天凌晨1点执行定时，每天一点执行一次统计注册人数数量
     */</span>
    <span class="token annotation punctuation">@Scheduled</span><span class="token punctuation">(</span>cron <span class="token operator">=</span> <span class="token string">&quot;0 0 1 * * ?&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">task2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//获取上一天的日期</span>
        <span class="token class-name">String</span> day <span class="token operator">=</span> <span class="token class-name">DateUtil</span><span class="token punctuation">.</span><span class="token function">formatDate</span><span class="token punctuation">(</span><span class="token class-name">DateUtil</span><span class="token punctuation">.</span><span class="token function">addDays</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dailyService<span class="token punctuation">.</span><span class="token function">createStatisticsByDay</span><span class="token punctuation">(</span>day<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>cron表达式怎么写？</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523203259210.png" alt="image-20220523203259210" tabindex="0" loading="lazy"><figcaption>image-20220523203259210</figcaption></figure><h3 id="统计数据图表显示" tabindex="-1"><a class="header-anchor" href="#统计数据图表显示" aria-hidden="true">#</a> 统计数据图表显示</h3><blockquote><p><a href="https://echarts.baidu.com/" target="_blank" rel="noopener noreferrer">https://echarts.baidu.com/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>这里我们采用ECharts来实现图标展示</p><p>给apache，用于图表展示，提供了常规的<a href="https://echarts.baidu.com/option.html#series-line" target="_blank" rel="noopener noreferrer">折线图<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>、<a href="https://echarts.baidu.com/option.html#series-line" target="_blank" rel="noopener noreferrer">柱状图<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>、<a href="https://echarts.baidu.com/option.html#series-scatter" target="_blank" rel="noopener noreferrer">散点图<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>、<a href="https://echarts.baidu.com/option.html#series-pie" target="_blank" rel="noopener noreferrer">饼图<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>、<a href="https://echarts.baidu.com/option.html#series-candlestick" target="_blank" rel="noopener noreferrer">K线图<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，用于统计的<a href="https://echarts.baidu.com/option.html#series-boxplot" target="_blank" rel="noopener noreferrer">盒形图<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，用于地理数据可视化的<a href="https://echarts.baidu.com/option.html#series-map" target="_blank" rel="noopener noreferrer">地图<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>、<a href="https://echarts.baidu.com/option.html#series-heatmap" target="_blank" rel="noopener noreferrer">热力图<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>、<a href="https://echarts.baidu.com/option.html#series-lines" target="_blank" rel="noopener noreferrer">线图<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，用于关系数据可视化的<a href="https://echarts.baidu.com/option.html#series-graph" target="_blank" rel="noopener noreferrer">关系图<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>、<a href="https://echarts.baidu.com/option.html#series-treemap" target="_blank" rel="noopener noreferrer">treemap<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>、<a href="https://echarts.baidu.com/option.html#series-sunburst" target="_blank" rel="noopener noreferrer">旭日图<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，多维数据可视化的<a href="https://echarts.baidu.com/option.html#series-parallel" target="_blank" rel="noopener noreferrer">平行坐标<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，还有用于 BI 的<a href="https://echarts.baidu.com/option.html#series-funnel" target="_blank" rel="noopener noreferrer">漏斗图<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，<a href="https://echarts.baidu.com/option.html#series-gauge" target="_blank" rel="noopener noreferrer">仪表盘<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，并且支持图与图之间的混搭</p></blockquote><p><strong>生成注册人数页面</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523205721881.png" alt="image-20220523205721881" tabindex="0" loading="lazy"><figcaption>image-20220523205721881</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523205857259.png" alt="image-20220523205857259" tabindex="0" loading="lazy"><figcaption>image-20220523205857259</figcaption></figure><p><strong>创建生成统计页面</strong></p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app-container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--表单--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form</span> <span class="token attr-name">:inline</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>demo-form-inline<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>日期<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-date-picker</span>
          <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>day<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>date<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>选择要统计的日期<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">value-format</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>yyyy-MM-dd<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>


      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span>
        <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btnDisabled<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>create()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>生成<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> sta <span class="token keyword">from</span> <span class="token string">&#39;@/api/sta&#39;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">day</span><span class="token operator">:</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">btnDisabled</span><span class="token operator">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            sta<span class="token punctuation">.</span><span class="token function">createStaData</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>day<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token comment">//提示信息</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;success&#39;</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&#39;生成数据成功!&#39;</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                    <span class="token comment">//跳转到图表显示页面</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">&#39;/sta/show&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>生成图表页面</strong></p><p>先来看下官方文档给出的实例</p><blockquote><p>可以看出我们只需要按要求在后端查询出数据，然后传给前端</p><p>前端做数据显示即可</p></blockquote><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523210923391.png" alt="image-20220523210923391" tabindex="0" loading="lazy"><figcaption>image-20220523210923391</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523211243291.png" alt="image-20220523211243291" tabindex="0" loading="lazy"><figcaption>image-20220523211243291</figcaption></figure><h3 id="样式调整" tabindex="-1"><a class="header-anchor" href="#样式调整" aria-hidden="true">#</a> 样式调整</h3><blockquote><p>参考配置手册：<a href="https://echarts.baidu.com/option.html#title" target="_blank" rel="noopener noreferrer">https://echarts.baidu.com/option.html#title<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523211442301.png" alt="image-20220523211442301" tabindex="0" loading="lazy"><figcaption>image-20220523211442301</figcaption></figure><h2 id="整合gateway网关" tabindex="-1"><a class="header-anchor" href="#整合gateway网关" aria-hidden="true">#</a> 整合Gateway网关</h2><blockquote><p><a href="https://blog.csdn.net/qq_45714272/article/details/123797260?spm=1001.2014.3001.5502" target="_blank" rel="noopener noreferrer">Spring全家桶--SpringCloud（中级）_小蜗牛耶的博客-CSDN博客_springcloud<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>详细介绍可看上文</p></blockquote><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523215349123.png" alt="image-20220523215349123" tabindex="0" loading="lazy"><figcaption>image-20220523215349123</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523215359541.png" alt="image-20220523215359541" tabindex="0" loading="lazy"><figcaption>image-20220523215359541</figcaption></figure><p><strong>建模块、改pom、yml、启动类</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523215621092.png" alt="image-20220523215621092" tabindex="0" loading="lazy"><figcaption>image-20220523215621092</figcaption></figure><h3 id="网关相关配置" tabindex="-1"><a class="header-anchor" href="#网关相关配置" aria-hidden="true">#</a> 网关相关配置</h3><blockquote><p>可以把之前控制类上写的@CrossOrigin注解去掉</p><p>所有请求通过gateway网关才会转发给相应微服务，</p><p>我们在gateway中解决跨域问题</p></blockquote><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523215653182.png" alt="image-20220523215653182" tabindex="0" loading="lazy"><figcaption>image-20220523215653182</figcaption></figure><h3 id="全局filter" tabindex="-1"><a class="header-anchor" href="#全局filter" aria-hidden="true">#</a> 全局Filter</h3><blockquote><p>固定写法</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gateway<span class="token punctuation">.</span>filter</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
 * 全局Filter，统一处理会员登录与外部不允许访问的服务
 * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
 *
 * <span class="token keyword">@author</span> qy
 * <span class="token keyword">@since</span> 2019-11-21
 */</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AuthGlobalFilter</span> <span class="token keyword">implements</span> <span class="token class-name">GlobalFilter</span><span class="token punctuation">,</span> <span class="token class-name">Ordered</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">AntPathMatcher</span> antPathMatcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AntPathMatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Mono</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token class-name">ServerWebExchange</span> exchange<span class="token punctuation">,</span> <span class="token class-name">GatewayFilterChain</span> chain<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ServerHttpRequest</span> request <span class="token operator">=</span> exchange<span class="token punctuation">.</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> path <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//谷粒学院api接口，校验用户必须登录</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>antPathMatcher<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token string">&quot;/api/**/auth/**&quot;</span><span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> tokenList <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> tokenList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">ServerHttpResponse</span> response <span class="token operator">=</span> exchange<span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token function">out</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
<span class="token comment">//                Boolean isCheck = JwtUtils.checkToken(tokenList.get(0));</span>
<span class="token comment">//                if(!isCheck) {</span>
                    <span class="token class-name">ServerHttpResponse</span> response <span class="token operator">=</span> exchange<span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> <span class="token function">out</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//                }</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//内部服务接口，不允许外部访问</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>antPathMatcher<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token string">&quot;/**/inner/**&quot;</span><span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">ServerHttpResponse</span> response <span class="token operator">=</span> exchange<span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token function">out</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> chain<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>exchange<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">Mono</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">out</span><span class="token punctuation">(</span><span class="token class-name">ServerHttpResponse</span> response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">JsonObject</span> message <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JsonObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        message<span class="token punctuation">.</span><span class="token function">addProperty</span><span class="token punctuation">(</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        message<span class="token punctuation">.</span><span class="token function">addProperty</span><span class="token punctuation">(</span><span class="token string">&quot;code&quot;</span><span class="token punctuation">,</span> <span class="token number">28004</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        message<span class="token punctuation">.</span><span class="token function">addProperty</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;鉴权失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bits <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">DataBuffer</span> buffer <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">bufferFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span>bits<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//response.setStatusCode(HttpStatus.UNAUTHORIZED);</span>
        <span class="token comment">//指定编码，否则在浏览器中会中文乱码</span>
        response<span class="token punctuation">.</span><span class="token function">getHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/json;charset=UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">writeWith</span><span class="token punctuation">(</span><span class="token class-name">Mono</span><span class="token punctuation">.</span><span class="token function">just</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="自定义异常处理" tabindex="-1"><a class="header-anchor" href="#自定义异常处理" aria-hidden="true">#</a> 自定义异常处理</h3><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523220133477.png" alt="image-20220523220133477" tabindex="0" loading="lazy"><figcaption>image-20220523220133477</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220523220142482.png" alt="image-20220523220142482" tabindex="0" loading="lazy"><figcaption>image-20220523220142482</figcaption></figure><h2 id="整合配置中心" tabindex="-1"><a class="header-anchor" href="#整合配置中心" aria-hidden="true">#</a> 整合配置中心</h2><blockquote><p><a href="https://blog.csdn.net/cjw12581/article/details/107463971" target="_blank" rel="noopener noreferrer">jar包和war包区别及理解_<em>猪耳朵</em>的博客-CSDN博客_jar war<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://blog.csdn.net/qq_45714272/article/details/123915679?spm=1001.2014.3001.5502" target="_blank" rel="noopener noreferrer">Spring全家桶--SpringCloud（高级）_小蜗牛耶的博客-CSDN博客<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><h3 id="为什么需要配置中心" tabindex="-1"><a class="header-anchor" href="#为什么需要配置中心" aria-hidden="true">#</a> 为什么需要配置中心</h3><p>在开发阶段不适合使用war包，因为在开发阶段，经常需要添加或删除Web应用程序的内容，更新 <a href="https://so.csdn.net/so/search?q=Servlet&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">Servlet<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>类文件，而每一次改动后，重新建立war包将是一件浪费时间的事情。在产品发布阶段，使用war文件比较合适的，因为在这个时候，几乎不需要再做什么改动了。</p><p>在系统开发过程中，开发者通常会将一些需要变更的参数、变量等从代码中分离出来独立管理，以独立的配置文件的形式存在。目的是让静态的系统工件或者交付物（如 WAR，JAR 包等）更好地和实际的物理运行环境进行适配。配置管理一般包含在系统部署的过程中，由系统管理员或者运维人员完成。配置变更是调整系统运行时的行为的有效手段。</p><p>如果微服务架构中没有使用统一配置中心时，所存在的问题：</p><p>- <strong>配置文件分散在各个项目里，不方便维护</strong></p><p>- <strong>配置内容安全与权限</strong></p><p>- <strong>更新配置后，项目需要重启</strong></p><p><mark>nacos配置中心：系统配置的集中管理（编辑、存储、分发）、动态更新不重启、回滚配置（变更管理、历史版本管理、变更审计）等所有与配置相关的活动。</mark></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220524092334617.png" alt="image-20220524092334617" tabindex="0" loading="lazy"><figcaption>image-20220524092334617</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220524092411906.png" alt="image-20220524092411906" tabindex="0" loading="lazy"><figcaption>image-20220524092411906</figcaption></figure><h3 id="jar包和war包区别及理解" tabindex="-1"><a class="header-anchor" href="#jar包和war包区别及理解" aria-hidden="true">#</a> jar包和war包区别及理解</h3><p><mark><strong>jar是类的归档文件</strong></mark> JAR（Java Archive，Java 归档文件）是与平台无关的文件格式，它允许将许多文件组合成一个压缩文件，为 J2EE 应用程序创建的jar文件是 EAR 文件（企业 jar文件），jar文件格式以流行的 ZIP 文件格式为基础。与 ZIP 文件不同的是，jar文件不仅用于压缩和发布，而且还用于部署和封装库、组件和插件程序，并可被像编译器和 JVM 这样的工具直接使用。在 jar中包含特殊的文件，如 manifests 和部署描述符，用来指示工具如何处理特定的 jar。 通常是开发时要引用通用类，打成jar包便于存放管理，当你使用某些功能时就需要这些jar包的支持，需要导入jar包。 jar包就是java的类进行编译生成的class文件打包的压缩包，包里面就是一些class文件。当我们自己使用Maven写一些java程序，进行打包生成jar包。同时在可以在其他的工程下使用，但是我们在这个工程依赖的jar包，在其他工程使用该JAR包也要导入。</p><p><mark><strong>war包是一个Web应用程序</strong></mark> 一个web程序进行打包便于部署的压缩包，里面包含我们web程序需要的一些东西，其中包括web.xml的配置文件，前端的页面文件，以及依赖的jar。便于我们部署工程，直接放到tomcat的webapps目录下，直接启动tomcat即可。同时，可以使用WinRAR查看war包，直接将后缀.war改成.rar。</p><p><strong><mark>jar包和war包区别</mark></strong></p><p><strong>jar</strong>是java普通项目打包，通常是开发时要引用通用类，打成jar包便于存放管理。当你使用某些功能时就需要这些jar包的支持，需要导入jar包。<strong>war</strong>是java web项目打包，web网站完成后，打成war包部署到服务器，目的是为了节省资源，提供效率。</p><h3 id="读取配置文件" tabindex="-1"><a class="header-anchor" href="#读取配置文件" aria-hidden="true">#</a> 读取配置文件</h3><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220524084846596.png" alt="image-20220524084846596" tabindex="0" loading="lazy"><figcaption>image-20220524084846596</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220524091637274.png" alt="image-20220524091637274" tabindex="0" loading="lazy"><figcaption>image-20220524091637274</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220524091913957.png" alt="image-20220524091913957" tabindex="0" loading="lazy"><figcaption>image-20220524091913957</figcaption></figure><p><strong>重启测试</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220524092023186.png" alt="image-20220524092023186" tabindex="0" loading="lazy"><figcaption>image-20220524092023186</figcaption></figure><h3 id="多配置文件加载" tabindex="-1"><a class="header-anchor" href="#多配置文件加载" aria-hidden="true">#</a> 多配置文件加载</h3><p><strong>在dev环境写两个配置文件，一个端口配置一个其他配置</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220524092603975.png" alt="image-20220524092603975" tabindex="0" loading="lazy"><figcaption>image-20220524092603975</figcaption></figure><p><strong>测试</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220524095202572.png" alt="image-20220524095202572" tabindex="0" loading="lazy"><figcaption>image-20220524095202572</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220524095446382.png" alt="image-20220524095446382" tabindex="0" loading="lazy"><figcaption>image-20220524095446382</figcaption></figure><h2 id="整合jenkins" tabindex="-1"><a class="header-anchor" href="#整合jenkins" aria-hidden="true">#</a> 整合Jenkins</h2><h3 id="代码上传到码云" tabindex="-1"><a class="header-anchor" href="#代码上传到码云" aria-hidden="true">#</a> 代码上传到码云</h3><p>省略...</p><h3 id="环境配置" tabindex="-1"><a class="header-anchor" href="#环境配置" aria-hidden="true">#</a> 环境配置</h3><p><strong>代码中需要包含Dockerfile文件</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220524095938488.png" alt="image-20220524095938488" tabindex="0" loading="lazy"><figcaption>image-20220524095938488</figcaption></figure><p><strong>在项目pom文件中指定打包类型，包含build部分内容</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220524100009338.png" alt="image-20220524100009338" tabindex="0" loading="lazy"><figcaption>image-20220524100009338</figcaption></figure><p><strong>安装jenkins环境</strong></p><p>在centos环境安装以下环境</p><ul><li>java</li><li>maven</li><li>git</li><li>docker</li></ul><p>其中maven的setttings文件最好改成国内源，不然构建的会很慢！</p><p><strong>配置环境变量</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220524100308095.png" alt="image-20220524100308095" tabindex="0" loading="lazy"><figcaption>image-20220524100308095</figcaption></figure><p><strong>部署jenkins</strong></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>[root@mysql jenkins]# ll
total 92716
-rw-r--r-- 1 root root 94928325 May 20 07:19 jenkins.war

[root@mysql jenkins]# nohup java -jar  /usr/local/jenkins/jenkins.war &gt;/usr/local/jenkins/jenkins.out &amp;
[1] 5570

[root@mysql jenkins]# nohup: ignoring input and redirecting stderr to stdout
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>登录</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220524101546657.png" alt="image-20220524101545453" tabindex="0" loading="lazy"><figcaption>image-20220524101545453</figcaption></figure><blockquote><p>下面这一步不太好用，退出之后还是没有updates文件夹，可以在网上下载好插件，然后把插件复制到plugins再打开就有这些功能了</p></blockquote><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220524101609591.png" alt="image-20220524101609591" tabindex="0" loading="lazy"><figcaption>image-20220524101609591</figcaption></figure><p><strong>jdk环境配置</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220524101903702.png" alt="image-20220524101903702" tabindex="0" loading="lazy"><figcaption>image-20220524101903702</figcaption></figure><p><strong>git配置</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220524102010071.png" alt="image-20220524102010071" tabindex="0" loading="lazy"><figcaption>image-20220524102010071</figcaption></figure><p><strong>maven配置</strong></p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220524102023279.png" alt="image-20220524102023279" tabindex="0" loading="lazy"><figcaption>image-20220524102023279</figcaption></figure><p>保持配置即可....</p><h3 id="构建作业" tabindex="-1"><a class="header-anchor" href="#构建作业" aria-hidden="true">#</a> 构建作业</h3><p>构建思路：</p><ul><li>建立任务</li><li>选择仓库代码</li><li>选择执行作业的方式</li></ul><p>1、建立任务</p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220524102201990.png" alt="image-20220524102201990" tabindex="0" loading="lazy"><figcaption>image-20220524102201990</figcaption></figure><p>2、选择仓库代码</p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220524102354875.png" alt="image-20220524102354875" tabindex="0" loading="lazy"><figcaption>image-20220524102354875</figcaption></figure><p>3、选择执行作业的方式</p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220524102537271.png" alt="image-20220524102537271" tabindex="0" loading="lazy"><figcaption>image-20220524102537271</figcaption></figure><p>代码如下：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment">#maven打包</span>
mvn clean package
<span class="token builtin class-name">echo</span> <span class="token string">&#39;package ok!&#39;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&#39;build start!&#39;</span>
<span class="token builtin class-name">cd</span> ./infrastructure/eureka_server
<span class="token assign-left variable">service_name</span><span class="token operator">=</span><span class="token string">&quot;eureka-server&quot;</span>
<span class="token assign-left variable">service_prot</span><span class="token operator">=</span><span class="token number">8761</span>
<span class="token comment">#查看镜像id</span>
<span class="token assign-left variable">IID</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">docker</span> images <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;<span class="token variable">$service_name</span>&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $3}&#39;</span><span class="token variable">)</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;IID <span class="token variable">$IID</span>&quot;</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-n</span> <span class="token string">&quot;<span class="token variable">$IID</span>&quot;</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;exist <span class="token variable">$SERVER_NAME</span> image,IID=<span class="token variable">$IID</span>&quot;</span>
    <span class="token comment">#删除镜像</span>
    <span class="token function">docker</span> rmi <span class="token parameter variable">-f</span> <span class="token variable">$service_name</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;delete <span class="token variable">$SERVER_NAME</span> image&quot;</span>
    <span class="token comment">#构建</span>
    <span class="token function">docker</span> build <span class="token parameter variable">-t</span> <span class="token variable">$service_name</span> <span class="token builtin class-name">.</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;build <span class="token variable">$SERVER_NAME</span> image&quot;</span>
<span class="token keyword">else</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;no exist <span class="token variable">$SERVER_NAME</span> image,build docker&quot;</span>
    <span class="token comment">#构建</span>
    <span class="token function">docker</span> build <span class="token parameter variable">-t</span> <span class="token variable">$service_name</span> <span class="token builtin class-name">.</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;build <span class="token variable">$SERVER_NAME</span> image&quot;</span>
<span class="token keyword">fi</span>
<span class="token comment">#查看容器id</span>
<span class="token assign-left variable">CID</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">docker</span> <span class="token function">ps</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;<span class="token variable">$SERVER_NAME</span>&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $1}&#39;</span><span class="token variable">)</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;CID <span class="token variable">$CID</span>&quot;</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-n</span> <span class="token string">&quot;<span class="token variable">$CID</span>&quot;</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;exist <span class="token variable">$SERVER_NAME</span> container,CID=<span class="token variable">$CID</span>&quot;</span>
    <span class="token comment">#停止</span>
    <span class="token function">docker</span> stop <span class="token variable">$service_name</span>
    <span class="token comment">#删除容器</span>
    <span class="token function">docker</span> <span class="token function">rm</span> <span class="token variable">$service_name</span>
<span class="token keyword">else</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;no exist <span class="token variable">$SERVER_NAME</span> container&quot;</span>
<span class="token keyword">fi</span>
<span class="token comment">#启动</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--name</span> <span class="token variable">$service_name</span> <span class="token parameter variable">--net</span><span class="token operator">=</span>host <span class="token parameter variable">-p</span> <span class="token variable">$service_prot</span><span class="token builtin class-name">:</span><span class="token variable">$service_prot</span> <span class="token variable">$service_name</span>
<span class="token comment">#查看启动日志</span>
<span class="token function">docker</span> logs  <span class="token variable">$service_name</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>第一次可能有些慢，之后就会很快</p></blockquote><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220521142847507.png" alt="image-20220521142847507" tabindex="0" loading="lazy"><figcaption>image-20220521142847507</figcaption></figure><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220524101515900.png" alt="image-20220524101515900" tabindex="0" loading="lazy"><figcaption>image-20220524101515900</figcaption></figure><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@mysql jenkins<span class="token punctuation">]</span><span class="token comment"># docker ps -a</span>
CONTAINER ID   IMAGE          COMMAND                  CREATED         STATUS         PORTS     NAMES
96d5a7108ef9   demojenkins2   <span class="token string">&quot;java -jar /demojenk…&quot;</span>   <span class="token number">2</span> minutes ago   Up <span class="token number">2</span> minutes             demojenkins2


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>部署成功啦！！！</p><figure><img src="https://typora-1259403628.cos.ap-nanjing.myqcloud.com/image-20220521143008672.png" alt="image-20220521143008672" tabindex="0" loading="lazy"><figcaption>image-20220521143008672</figcaption></figure></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/ssss/edit/main/demo/theme-docs/src/study-project/school/基础篇2.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page on GitHub" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><!----><!----></footer><nav class="page-nav"><a href="/study-project/school/%E5%9F%BA%E7%A1%80%E7%AF%871.html" class="nav-link prev" aria-label="基础开发"><div class="hint"><span class="arrow left"></span>Prev</div><div class="link"><!---->基础开发</div></a><a href="/study-project/school/%E6%80%BB%E7%BB%93%E7%AF%87.html" class="nav-link next" aria-label="面试总结"><div class="hint">Next<span class="arrow right"></span></div><div class="link">面试总结<!----></div></a></nav><div class="waline-wrapper" darkmode="false" style="display:block;"><div data-waline provider="Waline"><!--v-if--><div class="wl-comment"><!--v-if--><div class="wl-panel"><div class="wl-header item3"><!--[--><div class="wl-header-item"><label for="wl-nick">NickName</label><input id="wl-nick" class="wl-input wl-nick" name="nick" type="text" value></div><div class="wl-header-item"><label for="wl-mail">E-Mail</label><input id="wl-mail" class="wl-input wl-mail" name="mail" type="email" value></div><div class="wl-header-item"><label for="wl-link">Website</label><input id="wl-link" class="wl-input wl-link" name="link" type="text" value></div><!--]--></div><textarea id="wl-edit" class="wl-editor" placeholder="Write a comment here (Fill in the email address to receive an email notification when being replied)"></textarea><div class="wl-preview" style="display:none;"><hr><h4>Preview:</h4><div class="wl-content"></div></div><div class="wl-footer"><div class="wl-actions"><a href="https://guides.github.com/features/mastering-markdown/" title="Markdown Guide" aria-label="Markdown is supported" class="wl-action" target="_blank" rel="noopener noreferrer"><svg width="16" height="16" ariaHidden="true"><path d="M14.85 3H1.15C.52 3 0 3.52 0 4.15v7.69C0 12.48.52 13 1.15 13h13.69c.64 0 1.15-.52 1.15-1.15v-7.7C16 3.52 15.48 3 14.85 3zM9 11H7V8L5.5 9.92 4 8v3H2V5h2l1.5 2L7 5h2v6zm2.99.5L9.5 8H11V5h2v3h1.5l-2.51 3.5z" fill="currentColor"></path></svg></a><button type="button" class="wl-action" title="Emoji" style="display:none;"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M563.2 463.3 677 540c1.7 1.2 3.7 1.8 5.8 1.8.7 0 1.4-.1 2-.2 2.7-.5 5.1-2.1 6.6-4.4l25.3-37.8c1.5-2.3 2.1-5.1 1.6-7.8s-2.1-5.1-4.4-6.6l-73.6-49.1 73.6-49.1c2.3-1.5 3.9-3.9 4.4-6.6.5-2.7 0-5.5-1.6-7.8l-25.3-37.8a10.1 10.1 0 0 0-6.6-4.4c-.7-.1-1.3-.2-2-.2-2.1 0-4.1.6-5.8 1.8l-113.8 76.6c-9.2 6.2-14.7 16.4-14.7 27.5.1 11 5.5 21.3 14.7 27.4zM387 348.8h-45.5c-5.7 0-10.4 4.7-10.4 10.4v153.3c0 5.7 4.7 10.4 10.4 10.4H387c5.7 0 10.4-4.7 10.4-10.4V359.2c0-5.7-4.7-10.4-10.4-10.4zm333.8 241.3-41-20a10.3 10.3 0 0 0-8.1-.5c-2.6.9-4.8 2.9-5.9 5.4-30.1 64.9-93.1 109.1-164.4 115.2-5.7.5-9.9 5.5-9.5 11.2l3.9 45.5c.5 5.3 5 9.5 10.3 9.5h.9c94.8-8 178.5-66.5 218.6-152.7 2.4-5 .3-11.2-4.8-13.6zm186-186.1c-11.9-42-30.5-81.4-55.2-117.1-24.1-34.9-53.5-65.6-87.5-91.2-33.9-25.6-71.5-45.5-111.6-59.2-41.2-14-84.1-21.1-127.8-21.1h-1.2c-75.4 0-148.8 21.4-212.5 61.7-63.7 40.3-114.3 97.6-146.5 165.8-32.2 68.1-44.3 143.6-35.1 218.4 9.3 74.8 39.4 145 87.3 203.3.1.2.3.3.4.5l36.2 38.4c1.1 1.2 2.5 2.1 3.9 2.6 73.3 66.7 168.2 103.5 267.5 103.5 73.3 0 145.2-20.3 207.7-58.7 37.3-22.9 70.3-51.5 98.1-85 27.1-32.7 48.7-69.5 64.2-109.1 15.5-39.7 24.4-81.3 26.6-123.8 2.4-43.6-2.5-87-14.5-129zm-60.5 181.1c-8.3 37-22.8 72-43 104-19.7 31.1-44.3 58.6-73.1 81.7-28.8 23.1-61 41-95.7 53.4-35.6 12.7-72.9 19.1-110.9 19.1-82.6 0-161.7-30.6-222.8-86.2l-34.1-35.8c-23.9-29.3-42.4-62.2-55.1-97.7-12.4-34.7-18.8-71-19.2-107.9-.4-36.9 5.4-73.3 17.1-108.2 12-35.8 30-69.2 53.4-99.1 31.7-40.4 71.1-72 117.2-94.1 44.5-21.3 94-32.6 143.4-32.6 49.3 0 97 10.8 141.8 32 34.3 16.3 65.3 38.1 92 64.8 26.1 26 47.5 56 63.6 89.2 16.2 33.2 26.6 68.5 31 105.1 4.6 37.5 2.7 75.3-5.6 112.3z" fill="currentColor"></path></svg></button><button type="button" class="wl-action" title="GIF"><svg width="24" height="24" fill="currentcolor" viewBox="0 0 24 24"><path style="transform: translateY(0.5px)" d="M18.968 10.5H15.968V11.484H17.984V12.984H15.968V15H14.468V9H18.968V10.5V10.5ZM8.984 9C9.26533 9 9.49967 9.09367 9.687 9.281C9.87433 9.46833 9.968 9.70267 9.968 9.984V10.5H6.499V13.5H8.468V12H9.968V14.016C9.968 14.2973 9.87433 14.5317 9.687 14.719C9.49967 14.9063 9.26533 15 8.984 15H5.984C5.70267 15 5.46833 14.9063 5.281 14.719C5.09367 14.5317 5 14.2973 5 14.016V9.985C5 9.70367 5.09367 9.46933 5.281 9.282C5.46833 9.09467 5.70267 9.001 5.984 9.001H8.984V9ZM11.468 9H12.968V15H11.468V9V9Z"></path><path d="M18.5 3H5.75C3.6875 3 2 4.6875 2 6.75V18C2 20.0625 3.6875 21.75 5.75 21.75H18.5C20.5625 21.75 22.25 20.0625 22.25 18V6.75C22.25 4.6875 20.5625 3 18.5 3ZM20.75 18C20.75 19.2375 19.7375 20.25 18.5 20.25H5.75C4.5125 20.25 3.5 19.2375 3.5 18V6.75C3.5 5.5125 4.5125 4.5 5.75 4.5H18.5C19.7375 4.5 20.75 5.5125 20.75 6.75V18Z"></path></svg></button><input id="wl-image-upload" class="upload" type="file" accept=".png,.jpg,.jpeg,.webp,.bmp,.gif"><label for="wl-image-upload" class="wl-action" title="Upload Image"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M784 112H240c-88 0-160 72-160 160v480c0 88 72 160 160 160h544c88 0 160-72 160-160V272c0-88-72-160-160-160zm96 640c0 52.8-43.2 96-96 96H240c-52.8 0-96-43.2-96-96V272c0-52.8 43.2-96 96-96h544c52.8 0 96 43.2 96 96v480z" fill="currentColor"></path><path d="M352 480c52.8 0 96-43.2 96-96s-43.2-96-96-96-96 43.2-96 96 43.2 96 96 96zm0-128c17.6 0 32 14.4 32 32s-14.4 32-32 32-32-14.4-32-32 14.4-32 32-32zm462.4 379.2-3.2-3.2-177.6-177.6c-25.6-25.6-65.6-25.6-91.2 0l-80 80-36.8-36.8c-25.6-25.6-65.6-25.6-91.2 0L200 728c-4.8 6.4-8 14.4-8 24 0 17.6 14.4 32 32 32 9.6 0 16-3.2 22.4-9.6L380.8 640l134.4 134.4c6.4 6.4 14.4 9.6 24 9.6 17.6 0 32-14.4 32-32 0-9.6-4.8-17.6-9.6-24l-52.8-52.8 80-80L769.6 776c6.4 4.8 12.8 8 20.8 8 17.6 0 32-14.4 32-32 0-8-3.2-16-8-20.8z" fill="currentColor"></path></svg></label><button type="button" class="wl-action" title="Preview"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M710.816 654.301c70.323-96.639 61.084-230.578-23.705-314.843-46.098-46.098-107.183-71.109-172.28-71.109-65.008 0-126.092 25.444-172.28 71.109-45.227 46.098-70.756 107.183-70.756 172.106 0 64.923 25.444 126.007 71.194 172.106 46.099 46.098 107.184 71.109 172.28 71.109 51.414 0 100.648-16.212 142.824-47.404l126.53 126.006c7.058 7.06 16.297 10.979 26.406 10.979 10.105 0 19.343-3.919 26.402-10.979 14.467-14.467 14.467-38.172 0-52.723L710.816 654.301zm-315.107-23.265c-65.88-65.88-65.88-172.54 0-238.42 32.069-32.07 74.245-49.149 119.471-49.149 45.227 0 87.407 17.603 119.472 49.149 65.88 65.879 65.88 172.539 0 238.42-63.612 63.178-175.242 63.178-238.943 0zm0 0" fill="currentColor"></path><path d="M703.319 121.603H321.03c-109.8 0-199.469 89.146-199.469 199.38v382.034c0 109.796 89.236 199.38 199.469 199.38h207.397c20.653 0 37.384-16.645 37.384-37.299 0-20.649-16.731-37.296-37.384-37.296H321.03c-68.582 0-124.352-55.77-124.352-124.267V321.421c0-68.496 55.77-124.267 124.352-124.267h382.289c68.582 0 124.352 55.771 124.352 124.267V524.72c0 20.654 16.736 37.299 37.385 37.299 20.654 0 37.384-16.645 37.384-37.299V320.549c-.085-109.8-89.321-198.946-199.121-198.946zm0 0" fill="currentColor"></path></svg></button></div><div class="wl-info"><div class="wl-text-number">0 <!--v-if-->  Words</div><button type="button" class="wl-btn">Login</button><button type="submit" class="primary wl-btn" title="Cmd|Ctrl + Enter"><!--[-->Submit<!--]--></button></div><div class="wl-gif-popup"><input type="text" placeholder="Search GIF"><div class="wl-gallery" style="gap:6px;"><!--[--><!--]--></div><div class="wl-loading"><svg width="30" height="30" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="currentColor" strokeWidth="4" r="40" stroke-dasharray="85 30"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></circle></svg></div></div><div class="wl-emoji-popup"><!--[--><!--]--><!--v-if--></div></div></div><!--v-if--></div><div class="wl-meta-head"><div class="wl-count"><!--v-if--> Comments</div><ul class="wl-sort"><!--[--><li class="active">Latest</li><li class="">Oldest</li><li class="">Hottest</li><!--]--></ul></div><div class="wl-cards"><!--[--><!--]--></div><!--[--><div class="wl-loading"><svg width="30" height="30" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="currentColor" strokeWidth="4" r="40" stroke-dasharray="85 30"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></circle></svg></div><!--]--><div class="wl-power"> Powered by <a href="https://github.com/walinejs/waline" target="_blank" rel="noopener noreferrer"> Waline </a> v2.14.4</div></div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">Copyright © 2022 小蔡coding</div><div class="copyright">Copyright © 2022 xiaocai</div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-18c23253.js" defer></script>
  </body>
</html>
